Approach: Auto-seed Demo Project on First Login                                                                                                                                                                                 
                                                                                                                                                                                                                                  
  Problem                                                                                                                                                                                                                         
                                                                                                                                                                                                                                  
  New users land on an empty dashboard with no content. We want to automatically create the "Alvia Demo - Your Coffee Ritual" project (with template and questions) for every new user.                                           
                                                                                                                                                                                                                                  
  Key Challenge                                                                                                                                                                                                                   
                                                                                                                                                                                                                                  
  The upsertUser() in server/replit_integrations/auth/replitAuth.ts fires on every login (not just registration), since it's an upsert. We need to detect first-time users vs. returning users.                                   
                                                                                                                                                                                                                                  
  Implementation Plan                                                                                                                                                                                                             
                                                                                                                                                                                                                                  
  1. Create server/demo-seed.ts — new file containing the demo content and seeding logic                                                                                                                                          
                                                                                                                                                                                                                                  
  This file would export a single function:                                                                                                                                                                                       
                                                                                                                                                                                                                                  
  export async function seedDemoProjectIfNeeded(userId: string): Promise<void>                                                                                                                                                    
                                                                                                                                                                                                                                  
  Logic:                                                                                                                                                                                                                          
  - Call storage.getProjectsByUser(userId) — if the user already has projects, return early (no-op)                                                                                                                               
  - This naturally handles the "only on first login" requirement since returning users will already have projects                                                                                                                 
  - If no projects exist, create the workspace (if needed), project, template, and questions using storage.createWorkspace(), storage.createProject(), storage.createTemplate(), and storage.createQuestions()                    
                                                                                                                                                                                                                                  
  Content to hardcode (extracted from the existing Coffee Ritual project 28342b28-c296-45c3-a03d-fcbfc7e21f50 in the database):                                                                                                   
  - Project fields: name, description, objective, audienceContext, tone, contextType, avoidRules, strategicContext, consentAudioRecording, piiRedactionEnabled, etc.                                                              
  - Template fields: name, objective, tone, constraints, defaultRecommendedFollowUps                                                                                                                                              
  - All questions: questionText, questionType, guidance, timeHintSeconds, recommendedFollowUps, isRequired, orderIndex, plus any type-specific fields (scaleMin, scaleMax, multiSelectOptions)                                    
                                                                                                                                                                                                                                  
  Important: The actual content values need to be queried from the production database (project ID 28342b28-c296-45c3-a03d-fcbfc7e21f50) and hardcoded as constants.                                                              
                                                                                                                                                                                                                                  
  2. Modify server/replit_integrations/auth/replitAuth.ts — call the seeder after upsert                                                                                                                                          
                                                                                                                                                                                                                                  
  In the verify callback (line 71-78), add a call to seedDemoProjectIfNeeded after upsertUser:                                                                                                                                    
                                                                                                                                                                                                                                  
  const verify: VerifyFunction = async (tokens, verified) => {                                                                                                                                                                    
    const user = {};                                                                                                                                                                                                              
    updateUserSession(user, tokens);                                                                                                                                                                                              
    const claims = tokens.claims();                                                                                                                                                                                               
    await upsertUser(claims);                                                                                                                                                                                                     
                                                                                                                                                                                                                                  
    // Seed demo project for first-time users (fire-and-forget, non-blocking)                                                                                                                                                     
    seedDemoProjectIfNeeded(claims["sub"]).catch(err => {                                                                                                                                                                         
      console.error("Failed to seed demo project:", err);                                                                                                                                                                         
    });                                                                                                                                                                                                                           
                                                                                                                                                                                                                                  
    verified(null, user);                                                                                                                                                                                                         
  };                                                                                                                                                                                                                              
                                                                                                                                                                                                                                  
  Using fire-and-forget (.catch() without await) so the login flow isn't slowed down or blocked by demo seeding. The demo data will appear by the time the user reaches the dashboard.                                            
                                                                                                                                                                                                                                  
  3. No schema changes required                                                                                                                                                                                                   
                                                                                                                                                                                                                                  
  This approach uses existing tables and storage methods — no migrations needed.                                                                                                                                                  
                                                                                                                                                                                                                                  
  Files to Modify                                                                                                                                                                                                                 
  ┌───────────────────────────────────────────────┬────────────────────────────────────────────────────────────────────────┐                                                                                                      
  │                     File                      │                                 Change                                 │                                                                                                      
  ├───────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────┤                                                                                                      
  │ server/demo-seed.ts                           │ New file — demo content constants + seedDemoProjectIfNeeded() function │                                                                                                      
  ├───────────────────────────────────────────────┼────────────────────────────────────────────────────────────────────────┤                                                                                                      
  │ server/replit_integrations/auth/replitAuth.ts │ Add import + call to seedDemoProjectIfNeeded() in verify callback      │                                                                                                      
  └───────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────┘                                                                                                      
  Edge Cases                                                                                                                                                                                                                      
                                                                                                                                                                                                                                  
  - User deletes the demo project then logs in again: The seeder checks for any projects, not specifically the demo one. Once deleted, it won't recreate. This is probably the desired behavior — if a user deliberately deletes  
  it, don't re-add it.                                                                                                                                                                                                            
  - Race condition on rapid re-login: The project count check + insert isn't transactional, but duplicates are harmless and unlikely given the upsert pattern.                                                                    
  - Concurrent logins: Same as above — worst case is two demo projects, which is benign.                                                                                                                                          
                                                                                                                                                                                                                                  
  Alternative Considered (and rejected)                                                                                                                                                                                           
                                                                                                                                                                                                                                  
  Adding a hasReceivedDemo boolean column to the users table would be more precise (survives project deletion), but requires a schema migration for minimal benefit. Checking project count is simpler and sufficient. 